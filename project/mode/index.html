<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Wowchemy 5.0.0-beta.1 for Hugo"><meta name=author content="Ouail Kitouni"><meta name=description content="A regularization to make neural networks' output independent from certain features."><link rel=alternate hreflang=en-us href=https://okitouni.github.io/project/mode/><link rel=preconnect href=https://fonts.gstatic.com crossorigin><meta name=theme-color content="#2962ff"><script src=/js/mathjax-config.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin=anonymous async></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap"><link rel=stylesheet href=/css/wowchemy.min.f51aa7b8e7cf2863ae003a3e92431343.css><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","G-PSYH3QTWGB")</script><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/images/icon_hu78093045f097574c5772539a9c4bdc89_10083_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/images/icon_hu78093045f097574c5772539a9c4bdc89_10083_192x192_fill_lanczos_center_3.png><link rel=canonical href=https://okitouni.github.io/project/mode/><meta property="twitter:card" content="summary_large_image"><meta property="og:site_name" content="Ouail Kitouni"><meta property="og:url" content="https://okitouni.github.io/project/mode/"><meta property="og:title" content="MoDe: Controlling Classifier Bias | Ouail Kitouni"><meta property="og:description" content="A regularization to make neural networks' output independent from certain features."><meta property="og:image" content="https://okitouni.github.io/project/mode/featured.png"><meta property="twitter:image" content="https://okitouni.github.io/project/mode/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2017-01-01T00:00:00+00:00"><meta property="article:modified_time" content="2021-08-07T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://okitouni.github.io/project/mode/"},"headline":"MoDe: Controlling Classifier Bias","image":["https://okitouni.github.io/project/mode/featured.png"],"datePublished":"2017-01-01T00:00:00Z","dateModified":"2021-08-07T00:00:00Z","author":{"@type":"Person","name":"Ouail Kitouni"},"publisher":{"@type":"Organization","name":"Ouail Kitouni","logo":{"@type":"ImageObject","url":"https://okitouni.github.io/images/icon_hu78093045f097574c5772539a9c4bdc89_10083_192x192_fill_lanczos_center_3.png"}},"description":"A regularization to make neural networks' output independent from certain features."}</script><title>MoDe: Controlling Classifier Bias | Ouail Kitouni</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper><script src=/js/wowchemy-init.js></script><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class=page-header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Ouail Kitouni</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Ouail Kitouni</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#posts><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#publications><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span>
</a><a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span>
</a><a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></div><div class=page-body><article class="article article-project"><div class="article-container pt-3"><h1>MoDe: Controlling Classifier Bias</h1><div class=article-metadata><span class=article-date>Aug 7, 2021
</span><span class=middot-divider></span>
<a href=/project/mode/#disqus_thread></a></div><div class="btn-links mb-3"><a class="btn btn-outline-primary my-1 mr-1" href=#ZgotmplZ target=_blank rel=noopener>Project</a></div></div><div class=article-container><div class=article-style><p>Get the code <a href=https://github.com/okitouni/MoDe/tree/master target=_blank rel=noopener>here</a>.</p><h1 id=mode>MoDe</h1><p>Moment Decorrelation (MoDe) is a tool that can enforce decorrelation between some nuisance parameter (or protected attribute in ML fairness lingo) and the response of some model with gradient-based optimization (a neural network for example.) It can force trained models to have the same response across different values of the protected attribute but it can also go beyond simple decorrelation. For example, MoDe can constrain the response function to be linear or quadratic in the protected attribute. This can increase performance tremendously if the independence constraint is not necessary but instead one only cares about the &ldquo;smoothness&rdquo; of the dependence of the response on the protected attribute (which is a weaker constraint).</p><p>For more details please see our article at <a href=https://arxiv.org/abs/2010.09745 target=_blank rel=noopener>2010.09745</a>. (Please use <a href="https://inspirehep.net/literature?sort=mostrecent&amp;size=25&amp;page=1&amp;q=find%20eprint%202010.09745" target=_blank rel=noopener>INSPIRE-HEP</a> for citations.)</p><p>An implementation is available in each of TensorFlow and PyTorch. The notebooks in <a href=examples/>examples/</a> illustrate how MoDe is used and show how one can obtain different response functions on a toy example and on a W-tagging dataset.</p><h2 id=installation>Installation</h2><pre><code class=language-bash>pip install modeloss
</code></pre><p>The PyTorch implementation requires PyTorch 1.6.0 or newer.
The TensorFlow implementation requires TensorFlow 2.2.0 or newer.</p><h2 id=usage>Usage</h2><p>For PyTorch:</p><pre><code class=language-python>from modeloss.pytorch import MoDeLoss

flatness_loss = MoDeLoss(order=0)
loss = lambda pred,target,m,weights: lambd * flatness_loss(pred,target,m,weights)+\
                                            classification_loss(pred,target,weights)
</code></pre><p>For TensorFlow, replace <code>modeloss.pytorch</code> above with <code>modeloss.tf</code>.</p><h2 id=example>Example</h2><p>This is a toy example (located in <a href=examples/ToyExampleTF.ipynb>examples/ToyExampleTF.ipynb</a>) in which the signal (samples with label 1) is localized near the value 0.2 of the protected attribute <em>m</em>. While backgrounds (samples with label 0) are uniform in this feature, we note that this bias is introduced into any naive classifer. Indeed, we see that an unconstrained classifier (in the sense that it has no additional fairness regularization) has a large false positive rate for backgrounds near <em>m</em> = 0.2. Here we show how different MoDe regularizations (MoDe[n]) mitigate this bias by flattening the false positive rate as a function of the protected attribute <em>m</em> into its n&rsquo;th legendre decomposition (where n is the highest moment allowed; 0 is flat, 1 is linear, etc) .</p><p><img src=roc.svg alt=toy_example></p><p><strong>Left</strong>: The false positive rate versus mass (<em>m</em>) for various models at signal efficiencies (or true positive rates (TPR)) ε = 80, 50, 20% (each set of 3 identically colored and stylized lines correspond to the same model but with selection thresholds chosen to achieve the 3 desired TPRs). The bottom panel
shows that MoDe[1] and MoDe[2] completely overlap with the m-agnostic model for this simple
example, which is expected because the optimal classifier here has linear dependence on mass (see paper). <strong>Right</strong>: ROC curves for MoDe[0], MoDe[1], and MoDe[2] compared to the <em>m</em>-agnostic
model and a model with unconstrained mass dependence. As in the left panel, we see that <code>MoDe[1]</code>,
MoDe[2], and the <em>m</em>-agnostic ROC curves are nearly identical because the optimal classifier has
linear mass dependence in this simple example.
For more details see <a href=https://arxiv.org/pdf/2010.09745.pdf target=_blank rel=noopener>2010.09745</a>.</p></div><div class=article-tags><a class="badge badge-light" href=/tag/deep-learning/>Deep Learning</a>
<a class="badge badge-light" href=/tag/interpretability/>Interpretability</a></div><div class=share-box aria-hidden=true><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https://okitouni.github.io/project/mode/&amp;text=MoDe:%20Controlling%20Classifier%20Bias" target=_blank rel=noopener class=share-btn-twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https://okitouni.github.io/project/mode/&amp;t=MoDe:%20Controlling%20Classifier%20Bias" target=_blank rel=noopener class=share-btn-facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=MoDe:%20Controlling%20Classifier%20Bias&amp;body=https://okitouni.github.io/project/mode/" target=_blank rel=noopener class=share-btn-email><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https://okitouni.github.io/project/mode/&amp;title=MoDe:%20Controlling%20Classifier%20Bias" target=_blank rel=noopener class=share-btn-linkedin><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=MoDe:%20Controlling%20Classifier%20Bias%20https://okitouni.github.io/project/mode/" target=_blank rel=noopener class=share-btn-whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https://okitouni.github.io/project/mode/&amp;title=MoDe:%20Controlling%20Classifier%20Bias" target=_blank rel=noopener class=share-btn-weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=https://okitouni.github.io/><img class="avatar mr-3 avatar-circle" src=/author/ouail-kitouni/avatar_hu2181cbef5d7399608346d2294bd81f2a_2386892_270x270_fill_q75_lanczos_center.jpg alt="Ouail Kitouni"></a><div class=media-body><h5 class=card-title><a href=https://okitouni.github.io/>Ouail Kitouni</a></h5><h6 class=card-subtitle>Ph.D. Student</h6><p class=card-text>Working on the Science of Deep Learning.</p><ul class=network-icon aria-hidden=true><li><a href=/#contact><i class="fas fa-envelope"></i></a></li><li><a href="https://scholar.google.com/citations?user=ngbMs6sAAAAJ&amp;hl=en&amp;oi=ao" target=_blank rel=noopener><i class="ai ai-google-scholar"></i></a></li><li><a href=https://github.com/okitouni target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://www.linkedin.com/in/ouail-kitouni-645804187/ target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li><li><a href=/media/resume.pdf><i class="ai ai-cv"></i></a></li></ul></div></div><section id=comments></section><div class="article-widget content-widget-hr"><h3>Related</h3><ul><li><a href=/project/monotonic/>Monotonic Networks</a></li><li><a href=/publication/nuclr/>NuCLR: Nuclear Co-Learned Representations</a></li><li><a href=/publication/neemo/>NEEMo: Geometric Fitting using Neural Estimation of the Energy Mover's Distance</a></li><li><a href=/publication/mode/>Controlling Classifier Bias with Moment Decomposition: A Method to Enhance Searches for Resonances</a></li><li><a href=/publication/kbgen/>KBFormer: Diffusion over Structured Entities</a></li></ul></div><div class="project-related-pages content-widget-hr"><h2>Publications</h2><div class="media stream-item"><div class=media-body><h3 class="article-title mb-0 mt-0"><a href=/publication/mode/>Controlling Classifier Bias with Moment Decomposition: A Method to Enhance Searches for Resonances</a></h3><a href=/publication/mode/ class=summary-link><div class=article-style>Moment Decorrelation (MoDe) is a tool designed to ensure that a model&rsquo;s output remains uncorrelated with certain parameters, commonly termed as protected attributes in fairness contexts. Beyond mere decorrelation, MoDe can even shape the response function to adopt linear or quadratic relationships with the protected attribute.</div></a><div class="stream-meta article-metadata"><div><span><a href=/author/ouail-kitouni/>Ouail Kitouni</a></span>, <span><a href=/author/benjamin-nachman/>Benjamin Nachman</a></span>, <span><a href=/author/constantin-weisser/>Constantin Weisser</a></span>, <span><a href=/author/mike-williams/>Mike Williams</a></span></div></div><div class=btn-links><a class="btn btn-outline-primary my-1 mr-1 btn-sm" href=https://arxiv.org/abs/2010.09745 target=_blank rel=noopener>PDF
</a><a class="btn btn-outline-primary my-1 mr-1 btn-sm" href=https://github.com/okitouni/MoDe target=_blank rel=noopener>Code
</a><a class="btn btn-outline-primary my-1 mr-1 btn-sm" href=/project/mode/>Project
</a><a class="btn btn-outline-primary my-1 mr-1 btn-sm" href=https://ml4physicalsciences.github.io/2020/files/NeurIPS_ML4PS_2020_45_poster.pdf target=_blank rel=noopener>Poster
</a><a class="btn btn-outline-primary my-1 mr-1 btn-sm" href=https://youtu.be/ASqP0tcU6Ag target=_blank rel=noopener>Video
</a><a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="https://inspirehep.net/literature?sort=mostrecent&amp;size=25&amp;page=1&amp;q=find%20eprint%202010.09745" target=_blank rel=noopener>INSPIRE-HEP
</a><a class="btn btn-outline-primary my-1 mr-1 btn-sm" href=https://ml4physicalsciences.github.io/2020/files/NeurIPS_ML4PS_2020_45.pdf target=_blank rel=noopener>NeurIPS Abstract</a></div></div><div class=ml-3><a href=/publication/mode/><img src=/publication/mode/featured_hub2e09730819de9c6d35861ee229dff3f_442346_3f8d51a7bc36ece2ef8d1fc59e022f5e.png data-src=/publication/mode/featured_hub2e09730819de9c6d35861ee229dff3f_442346_150x0_resize_lanczos_3.png alt="Controlling Classifier Bias with Moment Decomposition: A Method to Enhance Searches for Resonances" class=lazyload></a></div></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class=powered-by></p><p class=powered-by>Published with
<a href=https://wowchemy.com target=_blank rel=noopener>Wowchemy</a> —
the free, <a href=https://github.com/wowchemy/wowchemy-hugo-modules target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy
</a><a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js></script><script>const code_highlighting=!0</script><script>const search_config={indexURI:"/index.json",minLength:1,threshold:.3},i18n={no_results:"No results found",placeholder:"Search...",results:"results found"},content_type={post:"Posts",project:"Projects",publication:"Publications",talk:"Talks",slides:"Slides"}</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script id=dsq-count-scr src=https://.disqus.com/count.js async></script><script src=/js/wowchemy.min.b642eae82ad9f09fa801bfdde4bce6b2.js></script></body></html>